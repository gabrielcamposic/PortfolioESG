:root{
  --bg-1: #01121a; /* page background start */
  --bg-2: #071726; /* page background end */
  --card: #081925;
  --muted: #9fb0bb;
  --accent: #6fe3c5;
  --accent-2: #4fc3f7;
  --glass: rgba(255,255,255,0.03);
  --nav-height: 56px;
}
*{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial}
body{margin:0;padding-top:var(--nav-height);background:linear-gradient(180deg,var(--bg-1),var(--bg-2));color:#eaf6f1;min-height:100vh}
/* layout containers used across pages */
.container, .wrap{max-width:980px;margin:28px auto;padding:18px}
.wrap{max-width:820px}
.header, .top{display:flex;align-items:center;justify-content:space-between}
.header h1, .top h1{margin:0;font-size:20px}
.controls{display:flex;gap:8px}
button{background:var(--accent);color:#033;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
button:active{transform:translateY(1px)}
a{color:var(--accent-2);text-decoration:none;padding:8px 12px;background:transparent;border-radius:8px}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:14px;margin-top:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}

/* top navigation - shared */
.site-nav{position:fixed;top:0;left:0;right:0;height:var(--nav-height);display:flex;align-items:center;justify-content:space-between;padding:0 18px;background:rgba(2,10,16,0.85);backdrop-filter:blur(6px);z-index:9999;border-bottom:1px solid rgba(255,255,255,0.03)}
.site-nav .brand{font-weight:700;color:#eaf6f1;margin-right:12px}
.site-nav .menu{display:flex;gap:6px;align-items:center}
.nav-link{color:var(--muted);text-decoration:none;padding:8px 10px;border-radius:8px;font-weight:600;font-size:13px}
.nav-link:hover{color:#fff;background:rgba(255,255,255,0.03)}
.nav-link.active{color:#042837;background:linear-gradient(90deg,var(--accent),var(--accent-2))}

/* hamburger toggle */
.nav-toggle{display:none;background:transparent;border:0;padding:8px;border-radius:8px;color:var(--muted);cursor:pointer}
.nav-toggle:focus{outline:2px solid rgba(110,227,197,0.3);outline-offset:2px}
.nav-toggle .hamburger{display:inline-block;width:20px;height:14px;position:relative}
.nav-toggle .hamburger:before,
.nav-toggle .hamburger:after,
.nav-toggle .hamburger div{content:'';position:absolute;left:0;right:0;height:2px;background:var(--muted);border-radius:2px}
.nav-toggle .hamburger:before{top:0}
.nav-toggle .hamburger div{top=6px}
.nav-toggle .hamburger:after{bottom:0}

/* mobile behavior */
@media (max-width:720px){
  .site-nav{padding:0 12px}
  .site-nav .menu{position:fixed;top:var(--nav-height);left:0;right:0;background:rgba(2,10,16,0.96);flex-direction:column;align-items:flex-start;padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);transform:translateY(-110%);transition:transform 220ms ease-in-out}
  .site-nav .menu.open{transform:translateY(0%)}
  .nav-toggle{display:inline-flex}
  .nav-link{display:block;width:100%;padding:10px 12px}
}
@media (max-width:560px){
  .header{flex-direction:column;align-items:flex-start}
  .controls{width:100%;justify-content:space-between}
  .breakdown .bars{flex-direction:column;height:auto}
  .bar{width:100%}
}
@media (max-width:520px){
  .metric-row{flex-direction:column;align-items:flex-start}
  .metric-bar-wrap{width:100%}
}

/* Dashboard row and chart sizing */
.dashboard-row{display:flex;gap:12px;align-items:flex-start}
.chart-card{flex:1;min-width:200px;min-height:180px;display:flex;flex-direction:column;align-items:stretch}
.chart-card canvas{width:100%;height:auto;display:block;max-height:480px}

/* small sparkline canvas inside table */
.spark-canvas{width:120px;height:28px;max-width:120px;display:block}

/* ensure table rows have some spacing for sparkline */
#stocksTable td{vertical-align:middle;padding:6px 8px}

/* Option B: Grid layout — portfolio full width above, two small charts side-by-side below */
.dashboard-row{
  display:grid;
  gap:12px;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: auto auto;
  grid-template-areas:
    "portfolio portfolio"
    "sector concentration";
  align-items:stretch;
}

/* map children by DOM order: first chart-card is portfolio (spans both columns) */
.dashboard-row > .chart-card:first-child{
  grid-area: portfolio;
  min-height: 320px; /* give the portfolio chart room */
}

/* remove obsolete second chart-card rules (donut/concentration removed) */

/* momentum arrow indicators */
.mom-up{ color:#2b8a3e; font-weight:700; margin-left:4px }
.mom-down{ color:#d9534f; font-weight:700; margin-left:4px }

/* KPI grid */
.kpi-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:12px;margin-top:12px}
.kpi{background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.01));padding:12px;border-radius:8px;text-align:center}
.kpi-val{font-size:20px;font-weight:700;color:var(--accent)}
.kpi-label{font-size:12px;color:var(--muted);margin-top:6px}

/* mini KPI cards under holdings table */
#peMomentum.mini-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; margin-top:12px }
.kpi.mini-kpi{ background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.01)); padding:10px; border-radius:8px; text-align:center }
.kpi.mini-kpi .kpi-val{ font-size:18px; color:var(--accent); font-weight:700 }
.kpi.mini-kpi .kpi-label{ font-size:12px; color:var(--muted); margin-top:6px }

@media (max-width:800px){
  #peMomentum.mini-grid{ grid-template-columns: repeat(2,1fr) }
}
@media (max-width:520px){
  #peMomentum.mini-grid{ grid-template-columns: 1fr }
}

/* range buttons */
.range-buttons{display:flex;gap:8px}
.range-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:6px 8px;border-radius:6px;cursor:pointer}
.range-btn.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#012}

/* GA mini-chart wrapper */
.ga-chart-wrap{margin-top:8px;}

/* treemap container placeholder */
.treemap{height:300px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.01));padding:8px;display:flex;align-items:center;justify-content:center}

/* table enhancements */
#stocksTable{width:100%;margin-top:12px;border-collapse:collapse}
#stocksTable th{text-align:left;padding:8px;color:var(--muted)}
#stocksTable td{padding:8px}
.badge{display:inline-block;padding:6px 8px;border-radius:999px;color:#012;font-weight:700}
.badge-green{background:#bff0da}
.badge-yellow{background:#fff2b8}
.badge-red{background:#ffd6d6}

/* responsive KPI tiles */
@media(max-width:900px){
  .kpi-grid{grid-template-columns:repeat(3,1fr)}
}
@media(max-width:560px){
  .kpi-grid{grid-template-columns:repeat(2,1fr)}
}

/* concentration list and summary */
.list li{ color: #eaf6f1; padding:6px 0; }
.concentration-summary{ margin-top:8px; font-size:14px; color:var(--muted); }

/* Meta footnote styling */
.meta-footnote{ color:var(--muted); font-size:12px; display:block; margin:4px 0; }
#meta{ padding:8px 12px; margin-bottom:8px }
#meta .meta-row{ margin:0 }

/* Reduce prominence of header h1 a bit when on dashboard pages */
.header h1{ font-size:18px }

/* --- Weight bars (conditional-formatting-like) --- */
#stocksTable td.weight-cell{ padding:6px 8px; min-width:160px; position:relative; vertical-align:middle }
#stocksTable .weight-bar-bg{ background:#0b1b1f; border-radius:10px; height:24px; overflow:hidden; position:relative }
#stocksTable .weight-bar{ position:absolute; left:0; top:0; bottom:0; width:0%; background:linear-gradient(90deg,#4fc3f7,#6fe3c5); transition:width 420ms ease; opacity:0.95 }
#stocksTable .weight-val{ position:absolute; left:10px; top:50%; transform:translateY(-50%); z-index:2; font-variant-numeric:tabular-nums; font-weight:700; color:#eaf6f1; text-shadow:0 1px 0 rgba(0,0,0,0.6) }

/* when bar is very dark, lighten text for contrast */
#stocksTable .weight-bar-bg{ background:linear-gradient(90deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01)); }

@media (max-width:640px){
  #stocksTable .weight-val{ left:8px; font-size:13px }
  #stocksTable .weight-bar-bg{ height:20px; border-radius:7px }
}

/* Ensure portfolioChart has a predictable height so the sector row is positioned correctly */
.dashboard-row > .chart-card:first-child > #portfolioChart{ height:320px; }
.dashboard-row > .chart-card:first-child .ga-chart-wrap{ height:80px; }

/* Table footnote styling */
.table-footnote {
  margin-top: 10px;
  padding: 8px 0;
  color: var(--muted);
  font-size: 0.85em;
  border-top: 1px solid rgba(255,255,255,0.05);
}
.table-footnote small {
  opacity: 0.8;
}

/* Diagnostics section with charts and KPIs side-by-side */
.diagnostics-row {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.diag-item {
  background: linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.01));
  border-radius: 8px;
  padding: 12px;
}
.diag-item.diag-with-kpi {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  gap: 16px;
}
.diag-chart-area {
  flex: 1;
  min-width: 0;
}
.diag-kpi-side {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-width: 90px;
  padding: 8px;
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
}
.kpi-mini {
  text-align: center;
}
.kpi-mini .kpi-val {
  font-size: 22px;
  font-weight: 700;
  color: var(--accent);
}
.kpi-mini .kpi-label {
  font-size: 11px;
  color: var(--muted);
  margin-top: 4px;
}

@media (max-width: 600px) {
  .diag-item.diag-with-kpi {
    flex-direction: column;
  }
  .diag-kpi-side {
    flex-direction: row;
    justify-content: center;
    min-width: auto;
    padding: 10px 16px;
  }
}

/* Correlation Heatmap styles */
.correlation-heatmap {
  overflow-x: auto;
  border-radius: 8px;
  background: rgba(255,255,255,0.01);
  padding: 8px;
}
.correlation-heatmap table {
  border-collapse: collapse;
  width: auto;
  margin: 0 auto;
}
.correlation-heatmap td,
.correlation-heatmap th {
  padding: 4px 6px;
  border: 1px solid rgba(255,255,255,0.04);
  font-size: 10px;
  text-align: center;
  white-space: nowrap;
}
.correlation-heatmap thead th {
  background: rgba(0,0,0,0.2);
  color: var(--muted);
  font-weight: 600;
  /* Vertical text orientation for column headers */
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
  height: 70px;
  vertical-align: bottom;
  padding: 6px 3px;
  white-space: nowrap;
}
.correlation-heatmap thead th:first-child {
  /* Corner cell - no rotation */
  writing-mode: horizontal-tb;
  transform: none;
  height: auto;
  vertical-align: middle;
}
.correlation-heatmap tbody th {
  background: rgba(0,0,0,0.2);
  color: var(--muted);
  font-weight: 600;
  text-align: left;
  padding: 4px 6px;
  white-space: nowrap;
}
.correlation-heatmap td {
  min-width: 28px;
  width: 28px;
  height: 28px;
}
.correlation-heatmap .no-data {
  color: var(--muted);
  font-size: 13px;
  padding: 20px;
  text-align: center;
}
/* Correlation legend scale */
.correlation-legend-scale {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  font-size: 11px;
  color: var(--muted);
}
.correlation-legend-scale .scale-gradient {
  width: 150px;
  height: 14px;
  border-radius: 3px;
  background: linear-gradient(90deg,
    rgba(220, 0, 80, 0.85) 0%,
    rgba(220, 180, 80, 0.85) 50%,
    rgba(0, 180, 80, 0.85) 100%
  );
  border: 1px solid rgba(255,255,255,0.1);
}
.correlation-legend-scale .scale-label {
  white-space: nowrap;
}
.correlation-legend-scale .scale-hint {
  margin-left: auto;
  opacity: 0.8;
}
/* Highlight stocks in current portfolio */
.correlation-heatmap th.in-portfolio {
  color: var(--accent) !important;
  font-weight: 700;
  text-shadow: 0 0 8px rgba(111, 227, 197, 0.5);
}
.correlation-heatmap td.portfolio-correlation {
  box-shadow: inset 0 0 0 2px var(--accent);
  position: relative;
}

/* Modal styles for portfolio composition */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.75);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(4px);
}
.modal-content {
  background: linear-gradient(180deg, #0a1f2d, #081925);
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.08);
  max-width: 600px;
  width: 90%;
  max-height: 85vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}
.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}
.modal-header h3 {
  margin: 0;
  font-size: 18px;
  color: #eaf6f1;
}
.modal-close {
  background: transparent;
  border: none;
  color: var(--muted);
  font-size: 24px;
  cursor: pointer;
  padding: 0 8px;
  line-height: 1;
}
.modal-close:hover {
  color: #fff;
}
.modal-body {
  padding: 20px;
}
.modal-meta {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 20px;
  font-size: 14px;
  color: var(--muted);
}
.modal-meta strong {
  color: #eaf6f1;
}
.modal-chart-container {
  margin-bottom: 16px;
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
  padding: 12px;
}
.composition-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.composition-item {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 13px;
}
.composition-item .stock-name {
  min-width: 90px;
  color: #eaf6f1;
  font-weight: 600;
}
.composition-item .weight-bar-container {
  flex: 1;
  height: 20px;
  background: rgba(255,255,255,0.05);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
}
.composition-item .weight-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  border-radius: 4px;
  transition: width 0.3s ease;
}
.composition-item .weight-value {
  min-width: 50px;
  text-align: right;
  color: var(--muted);
  font-variant-numeric: tabular-nums;
}

@media (max-width: 500px) {
  .modal-meta {
    grid-template-columns: 1fr;
  }
}

/* Composition History Legend */
.composition-history-section {
  margin-top: 20px;
  border-top: 1px solid rgba(255,255,255,0.05);
  padding-top: 8px;
}
.composition-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 8px 16px;
  margin-top: 12px;
  padding: 8px;
  background: rgba(255,255,255,0.02);
  border-radius: 6px;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--muted);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  transition: background 0.2s;
}
.legend-item:hover {
  background: rgba(255,255,255,0.05);
}
.legend-item.hidden {
  opacity: 0.4;
}
.legend-color {
  width: 12px;
  height: 12px;
  border-radius: 3px;
  flex-shrink: 0;
}
.legend-label {
  white-space: nowrap;
}

/* Performance Attribution Section */
.attribution-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.attribution-total {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  padding: 16px;
  background: linear-gradient(90deg, rgba(111, 227, 197, 0.1), rgba(79, 195, 247, 0.1));
  border-radius: 10px;
  border: 1px solid rgba(111, 227, 197, 0.2);
}
.attribution-total-label {
  font-size: 14px;
  color: var(--muted);
  font-weight: 500;
}
.attribution-total-value {
  font-size: 28px;
  font-weight: 700;
  color: var(--accent);
}
.attribution-total-value.negative {
  color: #e76f51;
}
.attribution-breakdown {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}
.attribution-chart-container {
  min-height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.attribution-details {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.attribution-item {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 12px;
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
}
.attribution-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.attribution-item-label {
  font-size: 13px;
  color: var(--muted);
}
.attribution-item-value {
  font-size: 16px;
  font-weight: 700;
  color: #5bd2a3;
}
.attribution-item-value.negative {
  color: #e76f51;
}
.attribution-bar-bg {
  height: 8px;
  background: rgba(255,255,255,0.05);
  border-radius: 4px;
  overflow: hidden;
}
.attribution-bar {
  height: 100%;
  border-radius: 4px;
  transition: width 0.4s ease;
}
.attribution-bar.positive {
  background: linear-gradient(90deg, #5bd2a3, #4fc3f7);
}
.attribution-bar.negative {
  background: linear-gradient(90deg, #e76f51, #f4a261);
}

@media (max-width: 640px) {
  .attribution-breakdown {
    grid-template-columns: 1fr;
  }
  .attribution-total {
    flex-direction: column;
    gap: 8px;
  }
}

/* Portfolio Metrics Grid */
.portfolio-metrics-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-top: 12px;
}
.metric-card {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.04);
  border-radius: 10px;
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.metric-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
}
.metric-card-title {
  font-size: 12px;
  color: var(--muted);
  font-weight: 500;
}
.metric-card-value {
  font-size: 18px;
  font-weight: 700;
  color: var(--accent);
  text-align: right;
}
.metric-card-value.negative {
  color: #e76f51;
}
.metric-card-value.positive {
  color: #5bd2a3;
}
.metric-card-desc {
  font-size: 10px;
  color: rgba(159, 176, 187, 0.7);
  line-height: 1.3;
}
.metric-card-bar {
  height: 6px;
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
  overflow: hidden;
}
.metric-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  border-radius: 3px;
  transition: width 0.4s ease;
  width: 0%;
}
.metric-bar-fill.tracking-error-bar {
  background: linear-gradient(90deg, #f4a261, #e76f51);
}

/* Momentum Gauge */
.metric-gauge-card {
  grid-column: span 2;
}
.metric-gauge-container {
  margin-top: 4px;
}
.metric-gauge-bg {
  height: 12px;
  background: linear-gradient(90deg, #e76f51 0%, #f4a261 25%, #ffd166 50%, #a8d5a2 75%, #5bd2a3 100%);
  border-radius: 6px;
  position: relative;
  overflow: visible;
}
.metric-gauge-fill {
  display: none; /* We use marker instead */
}
.metric-gauge-marker {
  position: absolute;
  top: -4px;
  width: 4px;
  height: 20px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 6px rgba(0,0,0,0.5);
  transform: translateX(-50%);
  transition: left 0.4s ease;
  left: 50%;
}
.metric-gauge-labels {
  display: flex;
  justify-content: space-between;
  margin-top: 4px;
  font-size: 10px;
  color: var(--muted);
}

@media (max-width: 900px) {
  .portfolio-metrics-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  .metric-gauge-card {
    grid-column: span 2;
  }
}
@media (max-width: 520px) {
  .portfolio-metrics-grid {
    grid-template-columns: 1fr;
  }
  .metric-gauge-card {
    grid-column: span 1;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   NOVA ORGANIZAÇÃO - Estilos adicionais
   ═══════════════════════════════════════════════════════════════════════════ */

/* Subsection dentro de cards */
.subsection {
  margin-top: 20px;
  padding-top: 16px;
  border-top: 1px solid rgba(255,255,255,0.05);
}
.subsection:first-child {
  margin-top: 12px;
  padding-top: 0;
  border-top: none;
}
.subsection h3 {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: var(--muted);
}
.subsection-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  flex-wrap: wrap;
  gap: 8px;
}
.subsection-header h3 {
  margin: 0;
}

/* History grid (2 colunas para Sharpe/Vol) */
.history-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  margin-top: 20px;
  padding-top: 16px;
  border-top: 1px solid rgba(255,255,255,0.05);
  align-items: start;
}
.history-grid > .subsection {
  display: flex;
  flex-direction: column;
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}
.history-grid > .subsection:first-child {
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}
.history-grid > .subsection > .chart-card {
  flex: 1;
}
@media (max-width: 700px) {
  .history-grid {
    grid-template-columns: 1fr;
  }
}

/* KPI mini inline (ao lado do título) */
.kpi-mini-inline {
  background: linear-gradient(90deg, rgba(111,227,197,0.15), rgba(79,195,247,0.15));
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 700;
  color: var(--accent);
}

/* Risk metrics grid */
.risk-metrics-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-bottom: 16px;
}
@media (max-width: 700px) {
  .risk-metrics-grid {
    grid-template-columns: 1fr 1fr;
  }
}
@media (max-width: 480px) {
  .risk-metrics-grid {
    grid-template-columns: 1fr;
  }
}

/* Valuation metrics grid */
.valuation-metrics-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-bottom: 16px;
}
.valuation-metrics-grid .metric-gauge-card {
  grid-column: span 1;
}
@media (max-width: 800px) {
  .valuation-metrics-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  .valuation-metrics-grid .metric-gauge-card {
    grid-column: span 2;
  }
}
@media (max-width: 520px) {
  .valuation-metrics-grid {
    grid-template-columns: 1fr;
  }
  .valuation-metrics-grid .metric-gauge-card {
    grid-column: span 1;
  }
}

/* Card section titles (h2) */
.card > h2 {
  margin: 0 0 16px 0;
  font-size: 16px;
  font-weight: 700;
  color: #eaf6f1;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}

/* ═══════════════════════════════════════════════════════════════════════════
   MEU PORTFOLIO - Estilos específicos
   ═══════════════════════════════════════════════════════════════════════════ */

/* Portfolio Summary Grid */
.portfolio-summary-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 12px;
}
.summary-card {
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 10px;
  padding: 16px;
  text-align: center;
}
.summary-card.highlight {
  background: linear-gradient(180deg, rgba(111,227,197,0.1), rgba(79,195,247,0.05));
  border-color: rgba(111,227,197,0.2);
}
.summary-label {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 8px;
}
.summary-value {
  font-size: 22px;
  font-weight: 700;
  color: var(--accent);
}
.summary-value.positive { color: #5bd2a3; }
.summary-value.negative { color: #e76f51; }
.summary-sub {
  font-size: 14px;
  font-weight: 600;
  margin-top: 4px;
}
.summary-sub.positive { color: #5bd2a3; }
.summary-sub.negative { color: #e76f51; }

@media (max-width: 900px) {
  .portfolio-summary-grid { grid-template-columns: repeat(3, 1fr); }
}
@media (max-width: 600px) {
  .portfolio-summary-grid { grid-template-columns: repeat(2, 1fr); }
}

/* Projection Grid */
.projection-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}
.projection-card {
  display: flex;
  align-items: center;
  gap: 16px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 12px;
  padding: 20px;
}
.projection-card.highlight-green {
  background: linear-gradient(135deg, rgba(91,210,163,0.15), rgba(79,195,247,0.1));
  border-color: rgba(91,210,163,0.3);
}
.projection-icon {
  font-size: 32px;
}
.projection-content {
  flex: 1;
}
.projection-label {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 4px;
}
.projection-value {
  font-size: 24px;
  font-weight: 700;
  color: var(--accent);
}
.projection-value.positive { color: #5bd2a3; }
.projection-value.negative { color: #e76f51; }
.projection-desc {
  font-size: 11px;
  color: rgba(159,176,187,0.7);
  margin-top: 4px;
}
.projection-disclaimer {
  margin-top: 16px;
  padding: 10px;
  background: rgba(242,192,87,0.1);
  border-radius: 8px;
  border-left: 3px solid #f2c057;
}
.projection-disclaimer small {
  color: var(--muted);
}

@media (max-width: 800px) {
  .projection-grid { grid-template-columns: 1fr; }
}

/* Tables */
.table-responsive {
  overflow-x: auto;
}
#positionsTable, #transactionsTable, #comparisonTable, #optimizedTransactionsTable {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}
#positionsTable th, #transactionsTable th, #comparisonTable th, #optimizedTransactionsTable th {
  text-align: left;
  padding: 10px 8px;
  color: var(--muted);
  font-weight: 600;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  white-space: nowrap;
}
#positionsTable td, #transactionsTable td, #comparisonTable td, #optimizedTransactionsTable td {
  padding: 10px 8px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  vertical-align: middle;
}
#positionsTable tr:hover, #transactionsTable tr:hover, #comparisonTable tr:hover, #optimizedTransactionsTable tr:hover {
  background: rgba(255,255,255,0.02);
}
.positive { color: #5bd2a3; }
.negative { color: #e76f51; }
.muted { color: var(--muted); opacity: 0.6; }
.no-data {
  text-align: center;
  color: var(--muted);
  padding: 20px !important;
}

/* Transaction badges */
.tx-badge {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}
.buy-badge {
  background: rgba(91,210,163,0.2);
  color: #5bd2a3;
}
.sell-badge {
  background: rgba(231,111,81,0.2);
  color: #e76f51;
}

/* Transaction filters */
.transactions-filters {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}
.filter-btn {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.1);
  color: var(--muted);
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
}
.filter-btn.active {
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  color: #012;
  border-color: transparent;
}

/* Allocation */
.allocation-container {
  display: flex;
  gap: 24px;
  align-items: center;
}
.allocation-chart {
  flex: 0 0 280px;
}
.allocation-legend {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.allocation-legend .legend-item {
  display: flex;
  align-items: center;
  gap: 10px;
}
.allocation-legend .legend-color {
  width: 14px;
  height: 14px;
  border-radius: 4px;
}
.allocation-legend .legend-label {
  flex: 1;
  font-size: 13px;
  color: #eaf6f1;
}
.allocation-legend .legend-value {
  font-size: 13px;
  font-weight: 600;
  color: var(--accent);
}

@media (max-width: 700px) {
  .allocation-container { flex-direction: column; }
  .allocation-chart { flex: none; width: 100%; max-width: 280px; }
}

/* Comparison */
.comparison-summary {
  display: flex;
  gap: 16px;
  margin-bottom: 16px;
}
.comparison-stat {
  flex: 1;
  text-align: center;
  padding: 12px;
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
}
.comparison-stat .stat-value {
  display: block;
  font-size: 28px;
  font-weight: 700;
  color: var(--accent);
}
.comparison-stat .stat-label {
  font-size: 12px;
  color: var(--muted);
}

/* Status badges */
.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
}
.status-badge.match {
  background: rgba(91,210,163,0.2);
  color: #5bd2a3;
}
.status-badge.missing {
  background: rgba(242,192,87,0.2);
  color: #f2c057;
}
.status-badge.extra {
  background: rgba(231,111,81,0.2);
  color: #e76f51;
}

/* Action badges */
.action-badge {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}
.action-buy {
  background: rgba(91,210,163,0.2);
  color: #5bd2a3;
}
.action-sell {
  background: rgba(231,111,81,0.2);
  color: #e76f51;
}
.action-ok {
  background: rgba(255,255,255,0.1);
  color: var(--muted);
}

/* Comparison row highlighting */
.comparison-missing { background: rgba(242,192,87,0.05); }
.comparison-extra { background: rgba(231,111,81,0.05); }

/* ═══════════════════════════════════════════════════════════════════════════
   PORTFOLIO EVOLUTION CHART
   ═══════════════════════════════════════════════════════════════════════════ */
.chart-controls {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
}
.range-btn {
  background: rgba(255, 255, 255, 0.05);
  color: var(--muted);
  border: 1px solid rgba(255, 255, 255, 0.1);
  padding: 6px 14px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}
.range-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
}
.range-btn.active {
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  color: #033;
  border-color: transparent;
}

.portfolio-evolution-chart {
  position: relative;
  width: 100%;
  height: 300px;
  margin-bottom: 12px;
}

.chart-legend {
  display: flex;
  gap: 20px;
  justify-content: center;
  flex-wrap: wrap;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: var(--muted);
}
.legend-dot {
  width: 12px;
  height: 12px;
  border-radius: 3px;
}
.legend-dot.blue {
  background: #4fc3f7;
}
.legend-dot.green {
  background: #68b36b;
}
.legend-dot.orange {
  background: #f2c057;
}

/* ═══════════════════════════════════════════════════════════════════════════
   REBALANCE ANALYSIS SECTION
   ═══════════════════════════════════════════════════════════════════════════ */
.section-desc {
  color: var(--muted);
  margin: 0 0 20px 0;
  font-size: 14px;
}

/* Verdict Banner */
.rebalance-verdict {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  padding: 20px;
  border-radius: 12px;
  margin-bottom: 24px;
  background: rgba(255, 255, 255, 0.02);
  border: 2px solid rgba(255, 255, 255, 0.1);
  transition: all 0.3s ease;
}
.rebalance-verdict.recommend {
  background: linear-gradient(135deg, rgba(43, 138, 62, 0.15), rgba(104, 179, 107, 0.1));
  border-color: #2b8a3e;
}
.rebalance-verdict.not-recommend {
  background: linear-gradient(135deg, rgba(231, 111, 81, 0.15), rgba(217, 83, 79, 0.1));
  border-color: #d9534f;
}
.rebalance-verdict.neutral {
  background: linear-gradient(135deg, rgba(242, 192, 87, 0.15), rgba(242, 192, 87, 0.1));
  border-color: #f2c057;
}
.verdict-icon {
  font-size: 40px;
}
.verdict-text {
  font-size: 18px;
  font-weight: 600;
  color: #fff;
}
.verdict-subtext {
  font-size: 13px;
  color: var(--muted);
  margin-top: 4px;
}

/* Metrics Grid */
.rebalance-metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}
.rebalance-metric-card {
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 10px;
  padding: 16px;
}
.metric-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}
.metric-icon {
  font-size: 20px;
}
.metric-title {
  font-size: 12px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.rebalance-metric-card .metric-value {
  font-size: 24px;
  font-weight: 700;
  color: #fff;
  margin-bottom: 4px;
}
.rebalance-metric-card .metric-value.positive {
  color: #2b8a3e;
}
.rebalance-metric-card .metric-value.negative {
  color: #d9534f;
}
.metric-detail {
  font-size: 11px;
  color: var(--muted);
}

/* Details Section */
.rebalance-details {
  background: rgba(255, 255, 255, 0.01);
  border-radius: 10px;
  padding: 16px;
  margin-bottom: 20px;
}
.rebalance-details h3 {
  margin: 0 0 16px 0;
  font-size: 15px;
  color: #fff;
}
.rebalance-summary-row {
  display: flex;
  flex-wrap: wrap;
  gap: 24px;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}
.rebalance-summary-item {
  display: flex;
  align-items: center;
  gap: 8px;
}
.rebalance-summary-item .summary-label {
  color: var(--muted);
  font-size: 13px;
}
.rebalance-summary-item .summary-value {
  font-weight: 600;
  font-size: 14px;
}

/* Rebalance Table */
#rebalanceTable {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}
#rebalanceTable th,
#rebalanceTable td {
  padding: 10px 12px;
  text-align: left;
  border-bottom: 1px solid rgba(255, 255, 255, 0.04);
}
#rebalanceTable th {
  background: rgba(255, 255, 255, 0.02);
  color: var(--muted);
  font-weight: 500;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
#rebalanceTable .action-buy {
  color: #2b8a3e;
  background: rgba(43, 138, 62, 0.1);
  padding: 4px 8px;
  border-radius: 4px;
  font-weight: 600;
  font-size: 11px;
}
#rebalanceTable .action-sell {
  color: #d9534f;
  background: rgba(217, 83, 79, 0.1);
  padding: 4px 8px;
  border-radius: 4px;
  font-weight: 600;
  font-size: 11px;
}
#rebalanceTable .action-hold {
  color: var(--muted);
  background: rgba(255, 255, 255, 0.05);
  padding: 4px 8px;
  border-radius: 4px;
  font-weight: 600;
  font-size: 11px;
}

/* Parameters Section */
.rebalance-params {
  background: rgba(255, 255, 255, 0.02);
  border-radius: 10px;
  padding: 16px;
  border: 1px dashed rgba(255, 255, 255, 0.1);
}
.rebalance-params h4 {
  margin: 0 0 16px 0;
  font-size: 14px;
  color: #fff;
}
.params-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  align-items: flex-end;
}
.param-item {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.param-item.full-width {
  flex-basis: 100%;
}
.param-item label {
  font-size: 12px;
  color: var(--muted);
}
.param-item input {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 6px;
  padding: 8px 12px;
  color: #fff;
  font-size: 14px;
  width: 150px;
}
.param-item input:focus {
  outline: none;
  border-color: var(--accent);
}
.param-hint {
  font-size: 10px;
  color: var(--accent);
}
.btn-recalculate {
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  color: #033;
  font-weight: 600;
  padding: 10px 20px;
  transition: all 0.2s ease;
}
.btn-recalculate:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(111, 227, 197, 0.3);
}
.btn-recalculate.recalculated {
  background: #2b8a3e;
  color: #fff;
}
.params-summary {
  margin-top: 12px;
  padding: 10px;
  background: rgba(79, 195, 247, 0.1);
  border-radius: 6px;
  border-left: 3px solid var(--accent-2);
}
.params-summary small {
  color: #fff;
}
.params-note {
  display: block;
  margin-top: 12px;
  color: var(--muted);
  font-size: 11px;
}

/* Verdict scenarios */
.verdict-content {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.verdict-detail {
  font-size: 12px;
  color: var(--accent-2);
}
.verdict-scenarios {
  display: flex;
  gap: 16px;
  font-size: 12px;
  margin-top: 8px;
}
.verdict-scenarios .scenario {
  padding: 6px 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 6px;
}

@media (max-width: 640px) {
  .rebalance-metrics-grid {
    grid-template-columns: 1fr 1fr;
  }
  .rebalance-verdict {
    flex-direction: column;
    text-align: center;
  }
  .params-grid {
    flex-direction: column;
  }
  .param-item input {
    width: 100%;
  }
  .verdict-scenarios {
    flex-direction: column;
    gap: 8px;
  }
}
