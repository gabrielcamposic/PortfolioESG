<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Data Explorer</title>
  <link rel="stylesheet" href="./css/styles.css">
  <style>
    /* small page-specific styles kept here for layout convenience */
    .explorer-controls{display:flex;gap:8px;align-items:center;margin-bottom:12px}
    .files-list{display:flex;gap:8px;flex-wrap:wrap}
    .file-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
    .file-btn.active{background:rgba(255,255,255,0.03);color:#fff}
    .viewer{margin-top:12px}
    .text-preview{white-space:pre-wrap;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px}
    .table-wrap{overflow:auto;max-height:520px;border-radius:8px;border:1px solid rgba(255,255,255,0.03)}
    table.data-table{width:100%;border-collapse:collapse}
    table.data-table th, table.data-table td{padding:8px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left}
    table.data-table th{position:sticky;top:0;background:rgba(0,0,0,0.2);backdrop-filter:blur(3px);z-index:2}
    .search-row{display:flex;gap:8px;margin:8px 0}
    .search-row label.visually-hidden{position:absolute;left:-9999px}
    .bar-chart{display:flex;gap:6px;align-items:end;height:280px;padding:12px;background:rgba(255,255,255,0.02);border-radius:8px}
    .bar-item{flex:1;display:flex;flex-direction:column;align-items:center}
    .bar-item .bar{width:100%;height:100%;background:linear-gradient(180deg,#5bd2a3,#2ca87f);border-radius:6px}
    .heatmap{overflow:auto}
    .heatmap table{border-collapse:collapse}
    .heatmap td, .heatmap th{Padding:4px;border:1px solid rgba(255,255,255,0.03);font-size:11px}
    .small-muted{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <script src="./js/load_nav.js"></script>

  <main class="container">
    <header class="header">
      <h1>Data Explorer</h1>
      <div class="controls">
        <a class="nav-link" href="./data/scored_stocks.csv">Raw CSV</a>
      </div>
    </header>

    <section class="card">
      <div class="explorer-controls">
        <div class="files-list">
          <button class="file-btn active" data-file="./data/scored_stocks.csv">Scored Stocks (CSV)</button>
          <button class="file-btn" data-file="./data/sector_pe.csv">Sector P/E (CSV)</button>
          <button class="file-btn" data-file="./data/correlation_matrix.csv">Correlation Matrix (CSV)</button>
        </div>
        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <button id="refresh" class="file-btn">Refresh</button>
          <a id="download" class="file-btn" href="./data/scored_stocks.csv" download>Download</a>
        </div>
      </div>

      <div class="viewer">
        <div id="textArea" style="display:none">
          <div class="small-muted">Preview (first 20000 chars)</div>
          <div id="textPreview" class="text-preview"></div>
        </div>

        <div id="tableArea" style="display:none">
          <div class="search-row">
            <label class="visually-hidden" for="searchInput">Search table</label>
            <input id="searchInput" placeholder="Search (substring across cells)" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#fff">
            <label class="visually-hidden" for="columnSelect">Filter column</label>
            <select id="columnSelect" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#fff">
              <option value="">All columns</option>
            </select>
            <button id="clearSearch" class="file-btn">Clear</button>
          </div>
          <div class="table-wrap"><table id="dataTable" class="data-table"><thead></thead><tbody></tbody></table></div>
        </div>

        <div id="chartArea" style="display:none">
          <div id="chartContainer"></div>
        </div>
      </div>

    </section>

    <footer class="footer small-muted">
      Quick viewer: shows the attached files `html/data/scored_stocks.csv`, `html/data/sector_pe.csv`, and `html/data/correlation_matrix.csv`.
    </footer>
  </main>

  <script src="./js/data_explorer.js"></script>
</body>
</html>
